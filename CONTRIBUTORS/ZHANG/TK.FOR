C     Originallly Coded:  Z. Zhang
C           Modified By:  D. Gilmore ---> (28 May 95)
C     -----------------------------------------------------
C     L. ADAMOWICZ RESEARCH / UNIVERSITY OF ARIZONA / CHEM.
C     -----------------------------------------------------
      SUBROUTINE TK(DFLAG,OVLAP,AX,AY,AZ,A1,BX,BY,BZ,A2,                      
     *              CX,CY,CZ,A3,DX,DY,DZ,A4,A5,A6,TKIN)       
C     -----------------------------------------------------
C     K.E. INTGL_1 = < psi(L) | -(1/2)DEL**2 _1 | psi {k) >
C     -----------------------------------------------------
      IMPLICIT REAL*8 (A-H,O-Z)
	INTEGER DFLAG        
	COMMON /DTK/ DTKDA1,DTKDA2,DTKDA5,DTKDAZ,DTKDBZ
	COMMON /DOVn/ DOVnDA1,DOVnDA2,DOVnDA5,DOVnDAZ,DOVnDBZ
C     -----------------------------------------------------
C     --- FOUR CENTER KINETIC ENERGY INTEGRAL ---                     
C     -----------------------------------------------------
C      COMMON/A2/ PI,PI2,PI3,PI32,PI52                                  
      DATA ONE,TWO,FOUR,SIX,EIGHT,HALF/1.,2.,4.,6.,8.,.5/              
C      WRITE(7,900) OVLAP,AX,AY,AZ,A1,BX,BY,BZ,A2,                      
C     1             CX,CY,CZ,A3,DX,DY,DZ,A4,A5,A6
C      WRITE(6,900) OVLAP,AX,AY,AZ,A1,BX,BY,BZ,A2,                      
C     1             CX,CY,CZ,A3,DX,DY,DZ,A4,A5,A6       
       
      GAMA1=A1+A2
C         ...Sum of Alpha Exponents (part 1)
C                                                      
      GAMA2=A3+A4                                                      
C         ...Sum of Alpha Exponents (part 2)
C
      GAMA3=A5+A6
C         ...Sum of Beta (Correlation) Exponents
C
      PX=(A1*AX+A2*BX)/GAMA1                                           
      QX=(A3*CX+A4*DX)/GAMA2                                            
      PY=(A1*AY+A2*BY)/GAMA1                                            
      QY=(A3*CY+A4*DY)/GAMA2                                            
      PZ=(A1*AZ+A2*BZ)/GAMA1                                            
      QZ=(A3*CZ+A4*DZ)/GAMA2                                           
      QCX=QX-CX 
      QCY=QY-CY 
      QCZ=QZ-CZ                                 
      PAX=PX-AX 
      PAY=PY-AY 
      PAZ=PZ-AZ                                 
      PBX=PX-BX 
      PBY=PY-BY 
      PBZ=PZ-BZ                                 
      PQX=PX-QX 
      PQY=PY-QY 
      PQZ=PZ-QZ                                
      PQX2=PQX*PQX
      PQY2=PQY*PQY 
      PQZ2=PQZ*PQZ                      
      G1PG2=GAMA1+GAMA2                                                
      G1RG2=GAMA1*GAMA2                                                
      XMIAN=G1RG2+GAMA3*G1PG2                                          
      DELT=G1RG2*GAMA3/XMIAN*FOUR                                      
      GA1DEL=DELT/GAMA1                                                
      OVXA11=PAX-PQX*GA1DEL/FOUR                                       
      OVYA11=PAY-PQY*GA1DEL/FOUR                                       
      OVZA11=PAZ-PQZ*GA1DEL/FOUR                 
      OVXB11=PBX-PQX*GA1DEL/FOUR                 
      OVYB11=PBY-PQY*GA1DEL/FOUR                                 
      OVZB11=PBZ-PQZ*GA1DEL/FOUR                                     
      OVXA12=OVXA11*OVXA11                                            
      OVYA12=OVYA11*OVYA11                                             
      OVZA12=OVZA11*OVZA11                                             
      POM=HALF/GAMA1-GA1DEL/EIGHT/GAMA1                                
      OVXA12=(OVXA12+POM)*OVLAP                                        
      OVYA12=(OVYA12+POM)*OVLAP                                        
      OVZA12=(OVZA12+POM)*OVLAP                                        
      OVXB12=OVXB11*OVXB11                                             
      OVYB12=OVYB11*OVYB11                                             
      OVZB12=OVZB11*OVZB11                                             
      OVXB12=(OVXB12+POM)*OVLAP                                         
      OVYB12=(OVYB12+POM)*OVLAP                                         
      OVZB12=(OVZB12+POM)*OVLAP                                        
      GA2DEL=DELT/GAMA2                                                
      OVXC21=QCX+PQX*GA2DEL/FOUR                                       
      OVYC21=QCY+PQY*GA2DEL/FOUR                                        
      OVZC21=QCZ+PQZ*GA2DEL/FOUR                                        
      OVXC22=OVXC21*OVXC21*OVLAP                                        
      OVYC22=OVYC21*OVYC21*OVLAP                                        
      OVZC22=OVZC21*OVZC21*OVLAP                                        
      POM=HALF/GAMA2-GA2DEL/EIGHT/GAMA2                                 
      POM=POM*OVLAP                                                     
      OVXC22=OVXC22+POM                                                 
      OVYC22=OVYC22+POM                                                 
      OVZC22=OVZC22+POM                                                 
      POM=GA2DEL/EIGHT/GAMA1                                            
      XA1XC2=ONE-HALF*PQX2*DELT                                         
      YA1YC2=ONE-HALF*PQY2*DELT                                         
      ZA1ZC2=ONE-HALF*PQZ2*DELT                                         
      XA1XC2=POM*XA1XC2                                                 
      YA1YC2=POM*YA1YC2                                                 
      ZA1ZC2=POM*ZA1ZC2                                                 
      XA1XC2=PAX*QCX+PQX/FOUR*(PAX*GA2DEL-QCX*GA1DEL)+XA1XC2            
      YA1YC2=PAY*QCY+PQY/FOUR*(PAY*GA2DEL-QCY*GA1DEL)+YA1YC2            
      ZA1ZC2=PAZ*QCz+PQZ/FOUR*(PAZ*GA2DEL-QCZ*GA1DEL)+ZA1ZC2            
      XA1XC2=XA1XC2*OVLAP                                               
      YA1YC2=YA1YC2*OVLAP                                               
      ZA1ZC2=ZA1ZC2*OVLAP                                               
      ACX=AX-CX 
      ACY=AY-CY 
      ACZ=AZ-CZ                                 
      OVA12=OVXA12+OVYA12+OVZA12                                        
      OVA11=TWO*(OVXA11*ACX+OVYA11*ACY+OVZA11*ACZ)*OVLAP                
      OVC22=OVXC22+OVYC22+OVZC22                                       
      OVC21=-TWO*(OVXC21*ACX+OVYC21*ACY+OVZC21*ACZ)*OVLAP              
      A1C2=-TWO*(XA1XC2+YA1YC2+ZA1ZC2)                                 
      TKIN=FOUR*A5*A6*(OVA12+OVA11+OVC22+OVC21+A1C2)                   
      IF(GAMA3) 10,12,10                                               
  12  A6DG3=HALF                                                       
      A5DG3=HALF                                                       
      GO TO 14                                                         
  10  A6DG3=A6/GAMA3                                                   
      A5DG3=A5/GAMA3                                                   
  14  CONTINUE                                                         
      TKIN=TKIN-FOUR*A1*A1*A6DG3*OVA12                                 
      OVB12=OVXB12+OVYB12+OVZB12                                       
      TKIN=TKIN-FOUR*A2*A2*A5DG3*OVB12                                 
      TKIN=TKIN+(SIX*(A1*A6DG3+A2*A5DG3)+                              
     *     FOUR*A5*A6*(ACX*ACX+ACY*ACY+ACZ*ACZ))*OVLAP                 
C     -----------------------------------------------------
C	DERIVATIVES:
C     -----------------------------------------------------
C	DTKDA1:
C	======================================================
	IF (DFLAG .EQ. 1) THEN
	PT1=(4.00D+00*A2**2.00D+00*A5)/GAMA3
	DPT1=0.00D+00
	PT2=(4.00D+00*A1**2.00D+00*A6)/GAMA3
	DPT2=8.00D+00*A1*A6DG3
	PT3=4.00D+00*A5*A6
	DPT3=0.00D+00

	P1=(1.00D+00/(2.00D+00*GAMA1))-(GA1DEL/(8.00D+00*GAMA1))
	DP1=-1.00D+00/(2.00D+00*GAMA1**2.00D+00)+GAMA2*GAMA3*(GAMA2+GAMA3)
	-/(2.00D+00*GAMA1*XMIAN**2.00D+00)+GAMA2*GAMA3/(2.00D+00*GAMA1**2.0
     -0D+00*XMIAN)
	P2=(1.00D+00/(2.00D+00*GAMA1))-(GA1DEL/(8.00D+00*GAMA1))
	DP2=-1.00D+00/(2.00D+00*GAMA1**2.00D+00)+GAMA2*GAMA3*(GAMA2+GAMA3)
	-/(2.00D+00*GAMA1*XMIAN**2.00D+00)+GAMA2*GAMA3/(2.00D+00*GAMA1**2.0
     -0D+00*XMIAN)
	P3=(1.00D+00/(2.00D+00*GAMA2))-(GA2DEL/(8.00D+00*GAMA2))
	DP3=GAMA1*GAMA3*(GAMA2+GAMA3)/(2.00D+00*GAMA2*XMIAN**2.00D+00)-GAM
	-A3/(2.00D+00*GAMA2*XMIAN)

	DGA1DEL=-4.00D+00*GAMA2*GAMA3*(GAMA2+GAMA3)/XMIAN**2.00D+00
	DGA2DEL=-4.00D+00*GAMA1*GAMA3*(GAMA2+GAMA3)/XMIAN**2.00D+00+4.00D+
	-00*GAMA3/XMIAN

	DPx=AX/GAMA1-(A1*AX+A2*BX)/GAMA1**2.00D+00
	DAx=0.00D+00
	DBx=0.00D+00 
	DCx=0.00D+00
	DQx=0.00D+00

	DPy=AY/GAMA1-(A1*AY+A2*BY)/GAMA1**2.00D+00
	DAy=0.00D+00
	DBy=0.00D+00
 	DCy=0.00D+00
	DQy=0.00D+00

	DPz=AZ/GAMA1-(A1*AZ+A2*BZ)/GAMA1**2.00D+00
	DAz=0.00D+00
	DBz=0.00D+00
 	DCz=0.00D+00 
      DQz=0.00D+00
 
	DPQx=DPx-DQx
	DPQy=DPy-DQy
	DPQz=DPz-DQz

	DPBx=DPx-DBx
	DPBy=DPy-DBy
	DPBz=DPz-DBz
	DPAx=DPx-DAx
	DPAy=DPy-DAy
	DPAz=DPz-DAz
	DQCx=DQx-DCx
	DQCy=DQy-DCy
	DQCz=DQz-DCz

	DACx=DAx-DCx
	DACy=DAy-DCy
	DACz=DAz-DCz

	DOVxB11=DPBx-(1.00D+00/4.00D+00)*(PQX*DGA1DEL+GA1DEL*DPQx)
	DOVyB11=DPBy-(1.00D+00/4.00D+00)*(PQY*DGA1DEL+GA1DEL*DPQy)
	DOVzB11=DPBz-(1.00D+00/4.00D+00)*(PQZ*DGA1DEL+GA1DEL*DPQz)
	DOVxA11=DPAx-(1.00D+00/4.00D+00)*(PQX*DGA1DEL+GA1DEL*DPQx) 
	DOVyA11=DPAy-(1.00D+00/4.00D+00)*(PQY*DGA1DEL+GA1DEL*DPQy)
	DOVzA11=DPAz-(1.00D+00/4.00D+00)*(PQZ*DGA1DEL+GA1DEL*DPQz)

	THETAx=OVXB11**2.00D+00+P1
	THETAy=OVYB11**2.00D+00+P1
	THETAz=OVZB11**2.00D+00+P1
	PHIx=OVXA11**2.00D+00+P2
	PHIy=OVYA11**2.00D+00+P2
	PHIz=OVZA11**2.00D+00+P2

	DTHETAx=2.00D+00*OVXB11*DOVxB11+DP1
	DTHETAy=2.00D+00*OVYB11*DOVyB11+DP1
	DTHETAz=2.00D+00*OVZB11*DOVzB11+DP1
	DPHIx=2.00D+00*OVXA11*DOVxA11+DP2
	DPHIy=2.00D+00*OVYA11*DOVyA11+DP2
	DPHIz=2.00D+00*OVZA11*DOVzA11+DP2
     
      DOVxB12=OVLAP*DTHETAx+THETAx*DOVnDA1
	DOVyB12=OVLAP*DTHETAy+THETAy*DOVnDA1
	DOVzB12=OVLAP*DTHETAz+THETAz*DOVnDA1
	DOVxA12=PHIx*DOVnDA1+OVLAP*DPHIx
	DOVyA12=PHIy*DOVnDA1+OVLAP*DPHIy
	DOVzA12=PHIz*DOVnDA1+OVLAP*DPHIz
	DOVxC21=DQCx+(1.00D+00/4.00D+00)*(PQX*DGA2DEL+GA2DEL*DPQx)
	DOVyC21=DQCy+(1.00D+00/4.00D+00)*(PQY*DGA2DEL+GA2DEL*DPQy)
      DOVzC21=DQCz+(1.00D+00/4.00D+00)*(PQZ*DGA2DEL+GA2DEL*DPQz)

	DOVB12=DOVxB12+DOVyB12+DOVzB12
      DOVA12=DOVxA12+DOVyA12+DOVzA12

	RHO=OVA12+OVA11+OVC22+OVC21+A1C2

	EPSILON=(OVXA11*ACX+OVYA11*ACY+OVZA11*ACZ)
	DEPSILON=(DOVxA11*ACX+DACx*OVXA11+DOVyA11*ACY+DACy*OVYA11+DOVzA11*
	-ACZ+DACz*OVZA11)

	DOVA11=2.00D+00*(DEPSILON*OVLAP+DOVnDA1*EPSILON)

	ZEDx=OVXC21**2.00D+00+P3
	ZEDy=OVYC21**2.00D+00+P3
	ZEDz=OVZC21**2.00D+00+P3

	DZEDx=2.00D+00*OVXC21*DOVxC21+DP3
	DZEDy=2.00D+00*OVYC21*DOVyC21+DP3
	DZEDz=2.00D+00*OVZC21*DOVzC21+DP3

	DOVxC22=(OVLAP*DZEDx+ZEDx*DOVnDA1)
	DOVyC22=(OVLAP*DZEDy+ZEDy*DOVnDA1)
	DOVzC22=(OVLAP*DZEDz+ZEDz*DOVnDA1)

	DOVC22=DOVxC22+DOVyC22+DOVzC22

	ZETA=(OVXC21*ACX+OVYC21*ACY+OVZC21*ACZ)
	DZETA=(DOVxC21*ACX+DACx*OVXC21+DOVyC21*ACY+DACy*OVYC21+DOVzC21*ACZ
	-+DACz*OVZC21)

	DOVC21=-2.00D+00*(DZETA*OVLAP+DOVnDA1*ZETA)

	HEREx=PAX*GA2DEL-QCX*GA1DEL
	HEREy=PAY*GA2DEL-QCY*GA1DEL
	HEREz=PAZ*GA2DEL-QCZ*GA1DEL

	UTAx=(1.00D+00-((PQX**2.00D+00*DELT)/2.00D+00))*(GA2DEL/(8.00D+00*
	-GAMA1))
	UTAy=(1.00D+00-((PQY**2.00D+00*DELT)/2.00D+00))*(GA2DEL/(8.00D+00*
	-GAMA1))
	UTAz=(1.00D+00-((PQZ**2.00D+00*DELT)/2.00D+00))*(GA2DEL/(8.00D+00*
	-GAMA1))


	REDx=PAX*QCX + (1.00D+00/4.00D+00)*PQX*(HEREx) + UTAx
	REDy=PAY*QCY + (1.00D+00/4.00D+00)*PQY*(HEREy) + UTAy
	REDz=PAZ*QCZ + (1.00D+00/4.00D+00)*PQZ*(HEREz) + UTAz							   

	DINHEREx=GA2DEL*(AX/GAMA1-(A1*AX+A2*BX)/GAMA1**2.00D+00)-4.00D+00*
	-GAMA1*GAMA3*(GAMA2+GAMA3)*PAX/XMIAN**2.00D+00+4.00D+00*GAMA2*GAMA3
     -*(GAMA2+GAMA3)*QCX/XMIAN**2.00D+00+4.00D+00*GAMA3*PAX/XMIAN
	DINHEREy=GA2DEL*(AY/GAMA1-(A1*AY+A2*BY)/GAMA1**2.00D+00)-4.00D+00*
	-GAMA1*GAMA3*(GAMA2+GAMA3)*PAY/XMIAN**2.00D+00+4.00D+00*GAMA2*GAMA3
     -*(GAMA2+GAMA3)*QCY/XMIAN**2.00D+00+4.00D+00*GAMA3*PAY/XMIAN
	DINHEREZ=GA2DEL*(AZ/GAMA1-(A1*AZ+A2*BZ)/GAMA1**2.00D+00)-4.00D+00*
	-GAMA1*GAMA3*(GAMA2+GAMA3)*PAZ/XMIAN**2.00D+00+4.00D+00*GAMA2*GAMA3
     -*(GAMA2+GAMA3)*QCZ/XMIAN**2.00D+00+4.00D+00*GAMA3*PAZ/XMIAN

	DUTAx=-(GAMA3*(GAMA2+GAMA3)*(1.00D+00-2.00D+00*GAMA3*G1RG2*PQX**2.
	-00D+00/XMIAN))/(2.00D+00*XMIAN**2.00D+00)+GAMA3*(2.00D+00*GAMA3*(G
     -AMA2+GAMA3)*G1RG2*PQX**2.00D+00/XMIAN**2.00D+00-2.00D+00*GAMA2*GAM
     -A3*PQX**2.00D+00/XMIAN-4.00D+00*GAMA3*G1RG2*PQX*(AX/GAMA1-(A1*AX+A
     -2*BX)/GAMA1**2.00D+00)/XMIAN)/(2.00D+00*XMIAN)
	DUTAy=-(GAMA3*(GAMA2+GAMA3)*(1.00D+00-2.00D+00*GAMA3*G1RG2*PQY**2.
	-00D+00/XMIAN))/(2.00D+00*XMIAN**2.00D+00)+GAMA3*(2.00D+00*GAMA3*(G
     -AMA2+GAMA3)*G1RG2*PQY**2.00D+00/XMIAN**2.00D+00-2.00D+00*GAMA2*GAM
     -A3*PQY**2.00D+00/XMIAN-4.00D+00*GAMA3*G1RG2*PQY*(AY/GAMA1-(A1*AY+A
     -2*BY)/GAMA1**2.00D+00)/XMIAN)/(2.00D+00*XMIAN)
	DUTAz=-(GAMA3*(GAMA2+GAMA3)*(1.00D+00-2.00D+00*GAMA3*G1RG2*PQZ**2.
	-00D+00/XMIAN))/(2.00D+00*XMIAN**2.00D+00)+GAMA3*(2.00D+00*GAMA3*(G
     -AMA2+GAMA3)*G1RG2*PQZ**2.00D+00/XMIAN**2.00D+00-2.00D+00*GAMA2*GAM
     -A3*PQZ**2.00D+00/XMIAN-4.00D+00*GAMA3*G1RG2*PQZ*(AZ/GAMA1-(A1*AZ+A
     -2*BZ)/GAMA1**2.00D+00)/XMIAN)/(2.00D+00*XMIAN)


	DREDx=(PAX*DQCx+QCX*DPAx)+(1.00D+00/4.00D+00)*(PQX*DINHEREx+HEREx*
	-DPQx)+DUTAx
	DREDy=(PAY*DQCy+QCY*DPAy)+(1.00D+00/4.00D+00)*(PQY*DINHEREy+HEREy*
	-DPQy)+DUTAy
	DREDz=(PAZ*DQCz+QCZ*DPAz)+(1.00D+00/4.00D+00)*(PQZ*DINHEREz+HEREz*
	-DPQz)+DUTAz	

	DAx1Cx2=(OVLAP*DREDx + REDx*DOVnDA1)
	DAy1Cy2=(OVLAP*DREDy + REDy*DOVnDA1)
	DAz1Cz2=(OVLAP*DREDz + REDz*DOVnDA1)

	DA1C2=-2.00D+00*(DAx1Cx2+DAy1Cy2+DAz1Cz2)

	DRHO=DOVA12+DOVA11+DOVC22+DOVC21+DA1C2

	DNKL=(DPT3*RHO + DRHO*PT3)

	DMKL=DNKL - (DPT2*OVA12 + DOVA12*PT2)

	DWKL=DMKL - (DPT1*OVB12 + DOVB12*PT1)

	QKL=(6.00D+00*(A1*A6DG3+A2*A5DG3)+4.00D+00*A5*A6*(ACX*ACX+ACY*ACY+
	-ACZ*ACZ))
	DQKL=6.00D+00*A6DG3

	DTKDA1=DWKL + QKL*DOVnDA1 + OVLAP*DQKL

C	WRITE(6,*)'OVLAP=',OVLAP
C	WRITE(6,*)'DOVLAP=',DOVnDA1
C	WRITE(6,*)'QKL=',QKL
C	WRITE(6,*)'DQKL=',DQKL
C	WRITE(6,*)'DWKL=',DWKL
C	STOP

C
C
C	DTKDA2:
C	======================================================
	PT1=(4.00D+00*A2**2.00D+00*A5)/GAMA3
	DPT1=0.00D+00
	PT2=(4.00D+00*A1**2.00D+00*A6)/GAMA3
	DPT2=0.00D+00
	PT3=4.00D+00*A5*A6
	DPT3=0.00D+00

	P1=(1.00D+00/(2.00D+00*GAMA1))-(GA1DEL/(8.00D+00*GAMA1))
	DP1=GAMA2*GAMA3*(GAMA1+GAMA3)/(2.00D+00*GAMA1*XMIAN**2.00D+00)-GAM
	-A3/(2.00D+00*GAMA1*XMIAN)
	P2=(1.00D+00/(2.00D+00*GAMA1))-(GA1DEL/(8.00D+00*GAMA1))
	DP2=GAMA2*GAMA3*(GAMA1+GAMA3)/(2.00D+00*GAMA1*XMIAN**2.00D+00)-GAM
	-A3/(2.00D+00*GAMA1*XMIAN)
	P3=(1.00D+00/(2.00D+00*GAMA2))-(GA2DEL/(8.00D+00*GAMA2))
	DP3=-1.00D+00/(2.00D+00*GAMA2**2.00D+00)+GAMA1*GAMA3*(GAMA1+GAMA3)
	-/(2.00D+00*GAMA2*XMIAN**2.00D+00)+GAMA1*GAMA3/(2.00D+00*GAMA2**2.0
     -0D+00*XMIAN)

	DGA1DEL=-4.00D+00*GAMA2*GAMA3*(GAMA1+GAMA3)/XMIAN**2.00D+00+4.00D+
	-00*GAMA3/XMIAN
	DGA2DEL=-4.00D+00*GAMA1*GAMA3*(GAMA1+GAMA3)/XMIAN**2.00D+00

	DPx=0.00D+00
	DAx=0.00D+00
	DBx=0.00D+00 
	DCx=0.00D+00
	DQx=CX/GAMA2-(A3*CX+A4*DX)/GAMA2**2.00D+00

	DPy=0.00D+00
	DAy=0.00D+00
	DBy=0.00D+00
 	DCy=0.00D+00
	DQy=CY/GAMA2-(A3*CY+A4*DY)/GAMA2**2.00D+00

	DPz=0.00D+00
	DAz=0.00D+00
	DBz=0.00D+00
 	DCz=0.00D+00 
      DQz=CZ/GAMA2-(A3*CZ+A4*DZ)/GAMA2**2.00D+00
 
	DPQx=DPx-DQx
	DPQy=DPy-DQy
	DPQz=DPz-DQz

	DPBx=DPx-DBx
	DPBy=DPy-DBy
	DPBz=DPz-DBz
	DPAx=DPx-DAx
	DPAy=DPy-DAy
	DPAz=DPz-DAz
	DQCx=DQx-DCx
	DQCy=DQy-DCy
	DQCz=DQz-DCz

	DACx=DAx-DCx
	DACy=DAy-DCy
	DACz=DAz-DCz

	DOVxB11=DPBx-(1.00D+00/4.00D+00)*(PQX*DGA1DEL+GA1DEL*DPQx)
	DOVyB11=DPBy-(1.00D+00/4.00D+00)*(PQY*DGA1DEL+GA1DEL*DPQy)
	DOVzB11=DPBz-(1.00D+00/4.00D+00)*(PQZ*DGA1DEL+GA1DEL*DPQz)
	DOVxA11=DPAx-(1.00D+00/4.00D+00)*(PQX*DGA1DEL+GA1DEL*DPQx) 
	DOVyA11=DPAy-(1.00D+00/4.00D+00)*(PQY*DGA1DEL+GA1DEL*DPQy)
	DOVzA11=DPAz-(1.00D+00/4.00D+00)*(PQZ*DGA1DEL+GA1DEL*DPQz)

	THETAx=OVXB11**2.00D+00+P1
	THETAy=OVYB11**2.00D+00+P1
	THETAz=OVZB11**2.00D+00+P1
	PHIx=OVXA11**2.00D+00+P2
	PHIy=OVYA11**2.00D+00+P2
	PHIz=OVZA11**2.00D+00+P2

	DTHETAx=2.00D+00*OVXB11*DOVxB11+DP1
	DTHETAy=2.00D+00*OVYB11*DOVyB11+DP1
	DTHETAz=2.00D+00*OVZB11*DOVzB11+DP1
	DPHIx=2.00D+00*OVXA11*DOVxA11+DP2
	DPHIy=2.00D+00*OVYA11*DOVyA11+DP2
	DPHIz=2.00D+00*OVZA11*DOVzA11+DP2
     
      DOVxB12=OVLAP*DTHETAx+THETAx*DOVnDA2
	DOVyB12=OVLAP*DTHETAy+THETAy*DOVnDA2
	DOVzB12=OVLAP*DTHETAz+THETAz*DOVnDA2
	DOVxA12=PHIx*DOVnDA2+OVLAP*DPHIx
	DOVyA12=PHIy*DOVnDA2+OVLAP*DPHIy
	DOVzA12=PHIz*DOVnDA2+OVLAP*DPHIz
	DOVxC21=DQCx+(1.00D+00/4.00D+00)*(PQX*DGA2DEL+GA2DEL*DPQx)
	DOVyC21=DQCy+(1.00D+00/4.00D+00)*(PQY*DGA2DEL+GA2DEL*DPQy)
      DOVzC21=DQCz+(1.00D+00/4.00D+00)*(PQZ*DGA2DEL+GA2DEL*DPQz)

	DOVB12=DOVxB12+DOVyB12+DOVzB12
      DOVA12=DOVxA12+DOVyA12+DOVzA12

	RHO=OVA12+OVA11+OVC22+OVC21+A1C2

	EPSILON=(OVXA11*ACX+OVYA11*ACY+OVZA11*ACZ)
	DEPSILON=(DOVxA11*ACX+DACx*OVXA11+DOVyA11*ACY+DACy*OVYA11+DOVzA11*
	-ACZ+DACz*OVZA11)

	DOVA11=2.00D+00*(DEPSILON*OVLAP+DOVnDA2*EPSILON)

	ZEDx=OVXC21**2.00D+00+P3
	ZEDy=OVYC21**2.00D+00+P3
	ZEDz=OVZC21**2.00D+00+P3

	DZEDx=2.00D+00*OVXC21*DOVxC21+DP3
	DZEDy=2.00D+00*OVYC21*DOVyC21+DP3
	DZEDz=2.00D+00*OVZC21*DOVzC21+DP3

	DOVxC22=(OVLAP*DZEDx+ZEDx*DOVnDA2)
	DOVyC22=(OVLAP*DZEDy+ZEDy*DOVnDA2)
	DOVzC22=(OVLAP*DZEDz+ZEDz*DOVnDA2)

	DOVC22=DOVxC22+DOVyC22+DOVzC22

	ZETA=(OVXC21*ACX+OVYC21*ACY+OVZC21*ACZ)
	DZETA=(DOVxC21*ACX+DACx*OVXC21+DOVyC21*ACY+DACy*OVYC21+DOVzC21*ACZ
	-+DACz*OVZC21)

	DOVC21=-2.00D+00*(DZETA*OVLAP+DOVnDA2*ZETA)

	HEREx=PAX*GA2DEL-QCX*GA1DEL
	HEREy=PAY*GA2DEL-QCY*GA1DEL
	HEREz=PAZ*GA2DEL-QCZ*GA1DEL

	UTAx=(1.00D+00-((PQX**2.00D+00*DELT)/2.00D+00))*(GA2DEL/(8.00D+00*
	-GAMA1))
	UTAy=(1.00D+00-((PQY**2.00D+00*DELT)/2.00D+00))*(GA2DEL/(8.00D+00*
	-GAMA1))
	UTAz=(1.00D+00-((PQZ**2.00D+00*DELT)/2.00D+00))*(GA2DEL/(8.00D+00*
	-GAMA1))


	REDx=PAX*QCX + (1.00D+00/4.00D+00)*PQX*(HEREx) + UTAx
	REDy=PAY*QCY + (1.00D+00/4.00D+00)*PQY*(HEREy) + UTAy
	REDz=PAZ*QCZ + (1.00D+00/4.00D+00)*PQZ*(HEREz) + UTAz							   

	DINHEREx=-4.00D+00*GAMA1*GAMA3*(GAMA1+GAMA3)*PAX/XMIAN**2.00D+00+4
	-.00D+00*GAMA2*GAMA3*(GAMA1+GAMA3)*QCX/XMIAN**2.00D+00-4.00D+00*GAM
     -A3*QCX/XMIAN-4.00D+00*GAMA2*GAMA3*(CX/GAMA2-(A3*CX+A4*DX)/GAMA2**2
     -.00D+00)/XMIAN
	DINHEREy=-4.00D+00*GAMA1*GAMA3*(GAMA1+GAMA3)*PAY/XMIAN**2.00D+00+4
	-.00D+00*GAMA2*GAMA3*(GAMA1+GAMA3)*QCY/XMIAN**2.00D+00-4.00D+00*GAM
     -A3*QCY/XMIAN-4.00D+00*GAMA2*GAMA3*(CY/GAMA2-(A3*CY+A4*DY)/GAMA2**2
     -.00D+00)/XMIAN
	DINHEREz=-4.00D+00*GAMA1*GAMA3*(GAMA1+GAMA3)*PAZ/XMIAN**2.00D+00+4
	-.00D+00*GAMA2*GAMA3*(GAMA1+GAMA3)*QCZ/XMIAN**2.00D+00-4.00D+00*GAM
     -A3*QCZ/XMIAN-4.00D+00*GAMA2*GAMA3*(CZ/GAMA2-(A3*CZ+A4*DZ)/GAMA2**2
     -.00D+00)/XMIAN

	DUTAx=-(GAMA3*(GAMA1+GAMA3)*(1.00D+00-2.00D+00*GAMA3*G1RG2*PQX**2
	-.00D+00/XMIAN))/(2.00D+00*XMIAN**2.00D+00)+GAMA3*(2.00D+00*GAMA3*(
     -GAMA1+GAMA3)*G1RG2*PQX**2.00D+00/XMIAN**2.00D+00-2.00D+00*GAMA1*GA
     -MA3*PQX**2.00D+00/XMIAN-4.00D+00*GAMA3*G1RG2*PQX*(-(CX/GAMA2)+(A3*
     -CX+A4*DX)/GAMA2**2.00D+00)/XMIAN)/(2.00D+00*XMIAN)
	DUTAy=-(GAMA3*(GAMA1+GAMA3)*(1.00D+00-2.00D+00*GAMA3*G1RG2*PQY**2
	-.00D+00/XMIAN))/(2.00D+00*XMIAN**2.00D+00)+GAMA3*(2.00D+00*GAMA3*(
     -GAMA1+GAMA3)*G1RG2*PQY**2.00D+00/XMIAN**2.00D+00-2.00D+00*GAMA1*GA
     -MA3*PQY**2.00D+00/XMIAN-4.00D+00*GAMA3*G1RG2*PQY*(-(CY/GAMA2)+(A3*
     -CY+A4*DY)/GAMA2**2.00D+00)/XMIAN)/(2.00D+00*XMIAN)
	DUTAz=-(GAMA3*(GAMA1+GAMA3)*(1.00D+00-2.00D+00*GAMA3*G1RG2*PQZ**2
	-.00D+00/XMIAN))/(2.00D+00*XMIAN**2.00D+00)+GAMA3*(2.00D+00*GAMA3*(
     -GAMA1+GAMA3)*G1RG2*PQZ**2.00D+00/XMIAN**2.00D+00-2.00D+00*GAMA1*GA
     -MA3*PQZ**2.00D+00/XMIAN-4.00D+00*GAMA3*G1RG2*PQZ*(-(CZ/GAMA2)+(A3*
     -CZ+A4*DZ)/GAMA2**2.00D+00)/XMIAN)/(2.00D+00*XMIAN)


	DREDx=(PAX*DQCx+QCX*DPAx)+(1.00D+00/4.00D+00)*(PQX*DINHEREx+HEREx*
	-DPQx)+DUTAx
	DREDy=(PAY*DQCy+QCY*DPAy)+(1.00D+00/4.00D+00)*(PQY*DINHEREy+HEREy*
	-DPQy)+DUTAy
	DREDz=(PAZ*DQCz+QCZ*DPAz)+(1.00D+00/4.00D+00)*(PQZ*DINHEREz+HEREz*
	-DPQz)+DUTAz	

	DAx1Cx2=(OVLAP*DREDx + REDx*DOVnDA2)
	DAy1Cy2=(OVLAP*DREDy + REDy*DOVnDA2)
	DAz1Cz2=(OVLAP*DREDz + REDz*DOVnDA2)

	DA1C2=-2.00D+00*(DAx1Cx2+DAy1Cy2+DAz1Cz2)

	DRHO=DOVA12+DOVA11+DOVC22+DOVC21+DA1C2

	DNKL=(DPT3*RHO + DRHO*PT3)

	DMKL=DNKL - (DPT2*OVA12 + DOVA12*PT2)

	DWKL=DMKL - (DPT1*OVB12 + DOVB12*PT1)

	QKL=(6.00D+00*(A1*A6DG3+A2*A5DG3)+4.00D+00*A5*A6*(ACX*ACX+ACY*ACY+
	-ACZ*ACZ))
	DQKL=0.00D+00

	DTKDA2=DWKL + QKL*DOVnDA2 + OVLAP*DQKL

C	WRITE(6,*)'OVLAP=',OVLAP
C	WRITE(6,*)'DOVLAP=',DOVnDA2
C	WRITE(6,*)'QKL=',QKL
C	WRITE(6,*)'DQKL=',DQKL
C	WRITE(6,*)'DWKL=',DWKL
C	STOP
C
C
C	DTKDA5:
C	======================================================
	PT1=(4.00D+00*A2**2.00D+00*A5)/GAMA3
	DPT1=-4.00D+00*A2**2.00D+00*A5/GAMA3**2.00D+00+4.00D+00*A2**2.00D+
	-00/GAMA3
	PT2=(4.00D+00*A1**2.00D+00*A6)/GAMA3
	DPT2=-4.00D+00*A1**2.00D+00*A6/GAMA3**2.00D+00
	PT3=4.00D+00*A5*A6
	DPT3=4.00D+00*A6

	P1=(1.00D+00/(2.00D+00*GAMA1))-(GA1DEL/(8.00D+00*GAMA1))
	DP1=GAMA2*GAMA3*G1PG2/(2.00D+00*GAMA1*XMIAN**2.00D+00)-GAMA2/(2.00
	-D+00*GAMA1*XMIAN)
	P2=(1.00D+00/(2.00D+00*GAMA1))-(GA1DEL/(8.00D+00*GAMA1))
	DP2=GAMA2*GAMA3*G1PG2/(2.00D+00*GAMA1*XMIAN**2.00D+00)-GAMA2/(2.00
	-D+00*GAMA1*XMIAN)
	P3=(1.00D+00/(2.00D+00*GAMA2))-(GA2DEL/(8.00D+00*GAMA2))
	DP3=GAMA1*GAMA3*G1PG2/(2.00D+00*GAMA2*XMIAN**2.00D+00)-GAMA1/(2.00
	-D+00*GAMA2*XMIAN)

	DGA1DEL=-4.00D+00*GAMA2*GAMA3*G1PG2/XMIAN**2.00D+00+4.00D+00*GAMA2
	-/XMIAN
	DGA2DEL=-4.00D+00*GAMA1*GAMA3*G1PG2/XMIAN**2.00D+00+4.00D+00*GAMA1
	-/XMIAN

	DPx=0.00D+00
	DAx=0.00D+00
	DBx=0.00D+00 
	DCx=0.00D+00
	DQx=0.00D+00

	DPy=0.00D+00
	DAy=0.00D+00
	DBy=0.00D+00
 	DCy=0.00D+00
	DQy=0.00D+00

	DPz=0.00D+00
	DAz=0.00D+00
	DBz=0.00D+00
 	DCz=0.00D+00 
      DQz=0.00D+00
 
	DPQx=DPx-DQx
	DPQy=DPy-DQy
	DPQz=DPz-DQz

	DPBx=DPx-DBx
	DPBy=DPy-DBy
	DPBz=DPz-DBz
	DPAx=DPx-DAx
	DPAy=DPy-DAy
	DPAz=DPz-DAz
	DQCx=DQx-DCx
	DQCy=DQy-DCy
	DQCz=DQz-DCz

	DACx=DAx-DCx
	DACy=DAy-DCy
	DACz=DAz-DCz

	DOVxB11=DPBx-(1.00D+00/4.00D+00)*(PQX*DGA1DEL+GA1DEL*DPQx)
	DOVyB11=DPBy-(1.00D+00/4.00D+00)*(PQY*DGA1DEL+GA1DEL*DPQy)
	DOVzB11=DPBz-(1.00D+00/4.00D+00)*(PQZ*DGA1DEL+GA1DEL*DPQz)
	DOVxA11=DPAx-(1.00D+00/4.00D+00)*(PQX*DGA1DEL+GA1DEL*DPQx) 
	DOVyA11=DPAy-(1.00D+00/4.00D+00)*(PQY*DGA1DEL+GA1DEL*DPQy)
	DOVzA11=DPAz-(1.00D+00/4.00D+00)*(PQZ*DGA1DEL+GA1DEL*DPQz)

	THETAx=OVXB11**2.00D+00+P1
	THETAy=OVYB11**2.00D+00+P1
	THETAz=OVZB11**2.00D+00+P1
	PHIx=OVXA11**2.00D+00+P2
	PHIy=OVYA11**2.00D+00+P2
	PHIz=OVZA11**2.00D+00+P2

	DTHETAx=2.00D+00*OVXB11*DOVxB11+DP1
	DTHETAy=2.00D+00*OVYB11*DOVyB11+DP1
	DTHETAz=2.00D+00*OVZB11*DOVzB11+DP1
	DPHIx=2.00D+00*OVXA11*DOVxA11+DP2
	DPHIy=2.00D+00*OVYA11*DOVyA11+DP2
	DPHIz=2.00D+00*OVZA11*DOVzA11+DP2
     
      DOVxB12=OVLAP*DTHETAx+THETAx*DOVnDA5
	DOVyB12=OVLAP*DTHETAy+THETAy*DOVnDA5
	DOVzB12=OVLAP*DTHETAz+THETAz*DOVnDA5
	DOVxA12=PHIx*DOVnDA5+OVLAP*DPHIx
	DOVyA12=PHIy*DOVnDA5+OVLAP*DPHIy
	DOVzA12=PHIz*DOVnDA5+OVLAP*DPHIz
	DOVxC21=DQCx+(1.00D+00/4.00D+00)*(PQX*DGA2DEL+GA2DEL*DPQx)
	DOVyC21=DQCy+(1.00D+00/4.00D+00)*(PQY*DGA2DEL+GA2DEL*DPQy)
      DOVzC21=DQCz+(1.00D+00/4.00D+00)*(PQZ*DGA2DEL+GA2DEL*DPQz)

	DOVB12=DOVxB12+DOVyB12+DOVzB12
      DOVA12=DOVxA12+DOVyA12+DOVzA12

	RHO=OVA12+OVA11+OVC22+OVC21+A1C2

	EPSILON=(OVXA11*ACX+OVYA11*ACY+OVZA11*ACZ)
	DEPSILON=(DOVxA11*ACX+DACx*OVXA11+DOVyA11*ACY+DACy*OVYA11+DOVzA11*
	-ACZ+DACz*OVZA11)

	DOVA11=2.00D+00*(DEPSILON*OVLAP+DOVnDA5*EPSILON)

	ZEDx=OVXC21**2.00D+00+P3
	ZEDy=OVYC21**2.00D+00+P3
	ZEDz=OVZC21**2.00D+00+P3

	DZEDx=2.00D+00*OVXC21*DOVxC21+DP3
	DZEDy=2.00D+00*OVYC21*DOVyC21+DP3
	DZEDz=2.00D+00*OVZC21*DOVzC21+DP3

	DOVxC22=(OVLAP*DZEDx+ZEDx*DOVnDA5)
	DOVyC22=(OVLAP*DZEDy+ZEDy*DOVnDA5)
	DOVzC22=(OVLAP*DZEDz+ZEDz*DOVnDA5)

	DOVC22=DOVxC22+DOVyC22+DOVzC22

	ZETA=(OVXC21*ACX+OVYC21*ACY+OVZC21*ACZ)
	DZETA=(DOVxC21*ACX+DACx*OVXC21+DOVyC21*ACY+DACy*OVYC21+DOVzC21*ACZ
	-+DACz*OVZC21)

	DOVC21=-2.00D+00*(DZETA*OVLAP+DOVnDA5*ZETA)

	HEREx=PAX*GA2DEL-QCX*GA1DEL
	HEREy=PAY*GA2DEL-QCY*GA1DEL
	HEREz=PAZ*GA2DEL-QCZ*GA1DEL

	UTAx=(1.00D+00-((PQX**2.00D+00*DELT)/2.00D+00))*(GA2DEL/(8.00D+00*
	-GAMA1))
	UTAy=(1.00D+00-((PQY**2.00D+00*DELT)/2.00D+00))*(GA2DEL/(8.00D+00*
	-GAMA1))
	UTAz=(1.00D+00-((PQZ**2.00D+00*DELT)/2.00D+00))*(GA2DEL/(8.00D+00*
	-GAMA1))


	REDx=PAX*QCX + (1.00D+00/4.00D+00)*PQX*(HEREx) + UTAx
	REDy=PAY*QCY + (1.00D+00/4.00D+00)*PQY*(HEREy) + UTAy
	REDz=PAZ*QCZ + (1.00D+00/4.00D+00)*PQZ*(HEREz) + UTAz							   

	DINHEREx=-4.00D+00*GAMA1*GAMA3*G1PG2*PAX/XMIAN**2.00D+00+4.00D+00*
	-GAMA2*GAMA3*G1PG2*QCX/XMIAN**2.00D+00+4.00D+00*GAMA1*PAX/XMIAN-4.0
     -0D+00*GAMA2*QCX/XMIAN
	DINHEREy=-4.00D+00*GAMA1*GAMA3*G1PG2*PAY/XMIAN**2.00D+00+4.00D+00*
	-GAMA2*GAMA3*G1PG2*QCY/XMIAN**2.00D+00+4.00D+00*GAMA1*PAY/XMIAN-4.0
     -0D+00*GAMA2*QCY/XMIAN
	DINHEREz=-4.00D+00*GAMA1*GAMA3*G1PG2*PAZ/XMIAN**2.00D+00+4.00D+00*
	-GAMA2*GAMA3*G1PG2*QCZ/XMIAN**2.00D+00+4.00D+00*GAMA1*PAZ/XMIAN-4.0
     -0D+00*GAMA2*QCZ/XMIAN

	DUTAx=-(GAMA3*G1PG2*(1.00D+00-2.00D+00*GAMA3*G1RG2*PQX**2.00D+00/X
	-MIAN))/(2.00D+00*XMIAN**2.00D+00)+GAMA3*(2.00D+00*GAMA3*G1PG2*G1RG
     -2*PQX**2.00D+00/XMIAN**2.00D+00-2.00D+00*G1RG2*PQX**2.00D+00/XMIAN
     -)/(2.00D+00*XMIAN)+(1.00D+00-2.00D+00*GAMA3*G1RG2*PQX**2.00D+00/XM
     -IAN)/(2.00D+00*XMIAN)
	DUTAy=-(GAMA3*G1PG2*(1.00D+00-2.00D+00*GAMA3*G1RG2*PQY**2.00D+00/X
	-MIAN))/(2.00D+00*XMIAN**2.00D+00)+GAMA3*(2.00D+00*GAMA3*G1PG2*G1RG
     -2*PQY**2.00D+00/XMIAN**2.00D+00-2.00D+00*G1RG2*PQY**2.00D+00/XMIAN
     -)/(2.00D+00*XMIAN)+(1.00D+00-2.00D+00*GAMA3*G1RG2*PQY**2.00D+00/XM
     -IAN)/(2.00D+00*XMIAN)
	DUTAz=-(GAMA3*G1PG2*(1.00D+00-2.00D+00*GAMA3*G1RG2*PQZ**2.00D+00/X
	-MIAN))/(2.00D+00*XMIAN**2.00D+00)+GAMA3*(2.00D+00*GAMA3*G1PG2*G1RG
     -2*PQZ**2.00D+00/XMIAN**2.00D+00-2.00D+00*G1RG2*PQZ**2.00D+00/XMIAN
     -)/(2.00D+00*XMIAN)+(1.00D+00-2.00D+00*GAMA3*G1RG2*PQZ**2.00D+00/XM
     -IAN)/(2.00D+00*XMIAN)


	DREDx=(PAX*DQCx+QCX*DPAx)+(1.00D+00/4.00D+00)*(PQX*DINHEREx+HEREx*
	-DPQx)+DUTAx
	DREDy=(PAY*DQCy+QCY*DPAy)+(1.00D+00/4.00D+00)*(PQY*DINHEREy+HEREy*
	-DPQy)+DUTAy
	DREDz=(PAZ*DQCz+QCZ*DPAz)+(1.00D+00/4.00D+00)*(PQZ*DINHEREz+HEREz*
	-DPQz)+DUTAz	

	DAx1Cx2=(OVLAP*DREDx + REDx*DOVnDA5)
	DAy1Cy2=(OVLAP*DREDy + REDy*DOVnDA5)
	DAz1Cz2=(OVLAP*DREDz + REDz*DOVnDA5)

	DA1C2=-2.00D+00*(DAx1Cx2+DAy1Cy2+DAz1Cz2)

	DRHO=DOVA12+DOVA11+DOVC22+DOVC21+DA1C2

	DNKL=(DPT3*RHO + DRHO*PT3)

	DMKL=DNKL - (DPT2*OVA12 + DOVA12*PT2)

	DWKL=DMKL - (DPT1*OVB12 + DOVB12*PT1)

	QKL=(6.00D+00*(A1*A6DG3+A2*A5DG3)+4.00D+00*A5*A6*(ACX*ACX+ACY*ACY+
	-ACZ*ACZ))
	DQKL=4.00D+00*(ACX**2.00D+00+ACY**2.00D+00+ACZ**2.00D+00)*A6+6.00D
	-+00*(-(A2*A5/GAMA3**2.00D+00)-A1*A6/GAMA3**2.00D+00+A2/GAMA3)

	DTKDA5=DWKL + QKL*DOVnDA5 + OVLAP*DQKL

C	WRITE(6,*)'OVLAP=',OVLAP
C	WRITE(6,*)'DOVLAP=',DOVnDA5
C	WRITE(6,*)'QKL=',QKL
C	WRITE(6,*)'DQKL=',DQKL
C	WRITE(6,*)'DWKL=',DWKL
C	STOP
C
C	DTKDAZ:
C	======================================================
	PT1=(4.00D+00*A2**2.00D+00*A5)/GAMA3
	DPT1=0.00D+00
	PT2=(4.00D+00*A1**2.00D+00*A6)/GAMA3
	DPT2=0.00D+00
	PT3=4.00D+00*A5*A6
	DPT3=0.00D+00

	P1=(1.00D+00/(2.00D+00*GAMA1))-(GA1DEL/(8.00D+00*GAMA1))
	DP1=0.00D+00
	P2=(1.00D+00/(2.00D+00*GAMA1))-(GA1DEL/(8.00D+00*GAMA1))
	DP2=0.00D+00
	P3=(1.00D+00/(2.00D+00*GAMA2))-(GA2DEL/(8.00D+00*GAMA2))
	DP3=0.00D+00

	DGA1DEL=0.00D+00
	DGA2DEL=0.00D+00

	DPx=0.00D+00
	DAx=0.00D+00
	DBx=0.00D+00 
	DCx=0.00D+00
	DQx=0.00D+00

	DPy=0.00D+00
	DAy=0.00D+00
	DBy=0.00D+00
 	DCy=0.00D+00
	DQy=0.00D+00

	DPz=A1/GAMA1
	DAz=1.00D+00
	DBz=0.00D+00
 	DCz=0.00D+00 
      DQz=0.00D+00
 
	DPQx=DPx-DQx
	DPQy=DPy-DQy
	DPQz=DPz-DQz

	DPBx=DPx-DBx
	DPBy=DPy-DBy
	DPBz=DPz-DBz
	DPAx=DPx-DAx
	DPAy=DPy-DAy
	DPAz=DPz-DAz
	DQCx=DQx-DCx
	DQCy=DQy-DCy
	DQCz=DQz-DCz

	DACx=DAx-DCx
	DACy=DAy-DCy
	DACz=DAz-DCz

	DOVxB11=DPBx-(1.00D+00/4.00D+00)*(PQX*DGA1DEL+GA1DEL*DPQx)
	DOVyB11=DPBy-(1.00D+00/4.00D+00)*(PQY*DGA1DEL+GA1DEL*DPQy)
	DOVzB11=DPBz-(1.00D+00/4.00D+00)*(PQZ*DGA1DEL+GA1DEL*DPQz)
	DOVxA11=DPAx-(1.00D+00/4.00D+00)*(PQX*DGA1DEL+GA1DEL*DPQx) 
	DOVyA11=DPAy-(1.00D+00/4.00D+00)*(PQY*DGA1DEL+GA1DEL*DPQy)
	DOVzA11=DPAz-(1.00D+00/4.00D+00)*(PQZ*DGA1DEL+GA1DEL*DPQz)

	THETAx=OVXB11**2.00D+00+P1
	THETAy=OVYB11**2.00D+00+P1
	THETAz=OVZB11**2.00D+00+P1
	PHIx=OVXA11**2.00D+00+P2
	PHIy=OVYA11**2.00D+00+P2
	PHIz=OVZA11**2.00D+00+P2

	DTHETAx=2.00D+00*OVXB11*DOVxB11+DP1
	DTHETAy=2.00D+00*OVYB11*DOVyB11+DP1
	DTHETAz=2.00D+00*OVZB11*DOVzB11+DP1
	DPHIx=2.00D+00*OVXA11*DOVxA11+DP2
	DPHIy=2.00D+00*OVYA11*DOVyA11+DP2
	DPHIz=2.00D+00*OVZA11*DOVzA11+DP2
     
      DOVxB12=OVLAP*DTHETAx+THETAx*DOVnDAZ
	DOVyB12=OVLAP*DTHETAy+THETAy*DOVnDAZ
	DOVzB12=OVLAP*DTHETAz+THETAz*DOVnDAZ
	DOVxA12=PHIx*DOVnDAZ+OVLAP*DPHIx
	DOVyA12=PHIy*DOVnDAZ+OVLAP*DPHIy
	DOVzA12=PHIz*DOVnDAZ+OVLAP*DPHIz
	DOVxC21=DQCx+(1.00D+00/4.00D+00)*(PQX*DGA2DEL+GA2DEL*DPQx)
	DOVyC21=DQCy+(1.00D+00/4.00D+00)*(PQY*DGA2DEL+GA2DEL*DPQy)
      DOVzC21=DQCz+(1.00D+00/4.00D+00)*(PQZ*DGA2DEL+GA2DEL*DPQz)

	DOVB12=DOVxB12+DOVyB12+DOVzB12
      DOVA12=DOVxA12+DOVyA12+DOVzA12

	RHO=OVA12+OVA11+OVC22+OVC21+A1C2

	EPSILON=(OVXA11*ACX+OVYA11*ACY+OVZA11*ACZ)
	DEPSILON=(DOVxA11*ACX+DACx*OVXA11+DOVyA11*ACY+DACy*OVYA11+DOVzA11*
	-ACZ+DACz*OVZA11)

	DOVA11=2.00D+00*(DEPSILON*OVLAP+DOVnDAZ*EPSILON)

	ZEDx=OVXC21**2.00D+00+P3
	ZEDy=OVYC21**2.00D+00+P3
	ZEDz=OVZC21**2.00D+00+P3

	DZEDx=2.00D+00*OVXC21*DOVxC21+DP3
	DZEDy=2.00D+00*OVYC21*DOVyC21+DP3
	DZEDz=2.00D+00*OVZC21*DOVzC21+DP3

	DOVxC22=(OVLAP*DZEDx+ZEDx*DOVnDAZ)
	DOVyC22=(OVLAP*DZEDy+ZEDy*DOVnDAZ)
	DOVzC22=(OVLAP*DZEDz+ZEDz*DOVnDAZ)

	DOVC22=DOVxC22+DOVyC22+DOVzC22

	ZETA=(OVXC21*ACX+OVYC21*ACY+OVZC21*ACZ)
	DZETA=(DOVxC21*ACX+DACx*OVXC21+DOVyC21*ACY+DACy*OVYC21+DOVzC21*ACZ
	-+DACz*OVZC21)

	DOVC21=-2.00D+00*(DZETA*OVLAP+DOVnDAZ*ZETA)

	HEREx=PAX*GA2DEL-QCX*GA1DEL
	HEREy=PAY*GA2DEL-QCY*GA1DEL
	HEREz=PAZ*GA2DEL-QCZ*GA1DEL

	UTAx=(1.00D+00-((PQX**2.00D+00*DELT)/2.00D+00))*(GA2DEL/(8.00D+00*
	-GAMA1))
	UTAy=(1.00D+00-((PQY**2.00D+00*DELT)/2.00D+00))*(GA2DEL/(8.00D+00*
	-GAMA1))
	UTAz=(1.00D+00-((PQZ**2.00D+00*DELT)/2.00D+00))*(GA2DEL/(8.00D+00*
	-GAMA1))


	REDx=PAX*QCX + (1.00D+00/4.00D+00)*PQX*(HEREx) + UTAx
	REDy=PAY*QCY + (1.00D+00/4.00D+00)*PQY*(HEREy) + UTAy
	REDz=PAZ*QCZ + (1.00D+00/4.00D+00)*PQZ*(HEREz) + UTAz							   

	DINHEREx=0.00D+00
	DINHEREy=0.00D+00
	DINHEREz=(-1.00D+00+A1/GAMA1)*GA2DEL

	DUTAx=0.00D+00
	DUTAy=0.00D+00
	DUTAz=-2.00D+00*A1*GAMA2*GAMA3**2.00D+00*PQZ/XMIAN**2.00D+00


	DREDx=(PAX*DQCx+QCX*DPAx)+(1.00D+00/4.00D+00)*(PQX*DINHEREx+HEREx*
	-DPQx)+DUTAx
	DREDy=(PAY*DQCy+QCY*DPAy)+(1.00D+00/4.00D+00)*(PQY*DINHEREy+HEREy*
	-DPQy)+DUTAy
	DREDz=(PAZ*DQCz+QCZ*DPAz)+(1.00D+00/4.00D+00)*(PQZ*DINHEREz+HEREz*
	-DPQz)+DUTAz	

	DAx1Cx2=(OVLAP*DREDx + REDx*DOVnDAZ)
	DAy1Cy2=(OVLAP*DREDy + REDy*DOVnDAZ)
	DAz1Cz2=(OVLAP*DREDz + REDz*DOVnDAZ)

	DA1C2=-2.00D+00*(DAx1Cx2+DAy1Cy2+DAz1Cz2)

	DRHO=DOVA12+DOVA11+DOVC22+DOVC21+DA1C2

	DNKL=(DPT3*RHO + DRHO*PT3)

	DMKL=DNKL - (DPT2*OVA12 + DOVA12*PT2)

	DWKL=DMKL - (DPT1*OVB12 + DOVB12*PT1)

	QKL=(6.00D+00*(A1*A6DG3+A2*A5DG3)+4.00D+00*A5*A6*(ACX*ACX+ACY*ACY+
	-ACZ*ACZ))
	DQKL=8.00D+00*ACZ*A5*A6

	DTKDAZ=DWKL + QKL*DOVnDAZ + OVLAP*DQKL

C	WRITE(6,*)'OVLAP=',OVLAP
C	WRITE(6,*)'DOVLAP=',DOVnDAZ
C	WRITE(6,*)'QKL=',QKL
C	WRITE(6,*)'DQKL=',DQKL
C	WRITE(6,*)'DWKL=',DWKL
C	STOP
C
C
C	DTKDBZ:
C	======================================================
	PT1=(4.00D+00*A2**2.00D+00*A5)/GAMA3
	DPT1=0.00D+00
	PT2=(4.00D+00*A1**2.00D+00*A6)/GAMA3
	DPT2=0.00D+00
	PT3=4*A5*A6
	DPT3=0.00D+00

	P1=(1.00D+00/(2.00D+00*GAMA1))-(GA1DEL/(8.00D+00*GAMA1))
	DP1=0.00D+00
	P2=(1.00D+00/(2.00D+00*GAMA1))-(GA1DEL/(8.00D+00*GAMA1))
	DP2=0.00D+00
	P3=(1.00D+00/(2.00D+00*GAMA2))-(GA2DEL/(8.00D+00*GAMA2))
	DP3=0.00D+00

	DGA1DEL=0.00D+00
	DGA2DEL=0.00D+00

	DPx=0.00D+00
	DAx=0.00D+00
	DBx=0.00D+00 
	DCx=0.00D+00
	DQx=0.00D+00

	DPy=0.00D+00
	DAy=0.00D+00
	DBy=0.00D+00
 	DCy=0.00D+00
	DQy=0.00D+00

	DPz=0.00D+00
	DAz=0.00D+00
	DBz=0.00D+00
 	DCz=1.00D+00 
      DQz=A3/GAMA2
 
	DPQx=DPx-DQx
	DPQy=DPy-DQy
	DPQz=DPz-DQz

	DPBx=DPx-DBx
	DPBy=DPy-DBy
	DPBz=DPz-DBz
	DPAx=DPx-DAx
	DPAy=DPy-DAy
	DPAz=DPz-DAz
	DQCx=DQx-DCx
	DQCy=DQy-DCy
	DQCz=DQz-DCz

	DACx=DAx-DCx
	DACy=DAy-DCy
	DACz=DAz-DCz

	DOVxB11=DPBx-(1.00D+00/4.00D+00)*(PQX*DGA1DEL+GA1DEL*DPQx)
	DOVyB11=DPBy-(1.00D+00/4.00D+00)*(PQY*DGA1DEL+GA1DEL*DPQy)
	DOVzB11=DPBz-(1.00D+00/4.00D+00)*(PQZ*DGA1DEL+GA1DEL*DPQz)
	DOVxA11=DPAx-(1.00D+00/4.00D+00)*(PQX*DGA1DEL+GA1DEL*DPQx) 
	DOVyA11=DPAy-(1.00D+00/4.00D+00)*(PQY*DGA1DEL+GA1DEL*DPQy)
	DOVzA11=DPAz-(1.00D+00/4.00D+00)*(PQZ*DGA1DEL+GA1DEL*DPQz)

	THETAx=OVXB11**2.00D+00+P1
	THETAy=OVYB11**2.00D+00+P1
	THETAz=OVZB11**2.00D+00+P1
	PHIx=OVXA11**2.00D+00+P2
	PHIy=OVYA11**2.00D+00+P2
	PHIz=OVZA11**2.00D+00+P2

	DTHETAx=2.00D+00*OVXB11*DOVxB11+DP1
	DTHETAy=2.00D+00*OVYB11*DOVyB11+DP1
	DTHETAz=2.00D+00*OVZB11*DOVzB11+DP1
	DPHIx=2.00D+00*OVXA11*DOVxA11+DP2
	DPHIy=2.00D+00*OVYA11*DOVyA11+DP2
	DPHIz=2.00D+00*OVZA11*DOVzA11+DP2
     
      DOVxB12=OVLAP*DTHETAx+THETAx*DOVnDBZ
	DOVyB12=OVLAP*DTHETAy+THETAy*DOVnDBZ
	DOVzB12=OVLAP*DTHETAz+THETAz*DOVnDBZ
	DOVxA12=PHIx*DOVnDBZ+OVLAP*DPHIx
	DOVyA12=PHIy*DOVnDBZ+OVLAP*DPHIy
	DOVzA12=PHIz*DOVnDBZ+OVLAP*DPHIz
	DOVxC21=DQCx+(1.00D+00/4.00D+00)*(PQX*DGA2DEL+GA2DEL*DPQx)
	DOVyC21=DQCy+(1.00D+00/4.00D+00)*(PQY*DGA2DEL+GA2DEL*DPQy)
      DOVzC21=DQCz+(1.00D+00/4.00D+00)*(PQZ*DGA2DEL+GA2DEL*DPQz)

	DOVB12=DOVxB12+DOVyB12+DOVzB12
      DOVA12=DOVxA12+DOVyA12+DOVzA12

	RHO=OVA12+OVA11+OVC22+OVC21+A1C2

	EPSILON=(OVXA11*ACX+OVYA11*ACY+OVZA11*ACZ)
	DEPSILON=(DOVxA11*ACX+DACx*OVXA11+DOVyA11*ACY+DACy*OVYA11+DOVzA11*
	-ACZ+DACz*OVZA11)

	DOVA11=2.00D+00*(DEPSILON*OVLAP+DOVnDBZ*EPSILON)

	ZEDx=OVXC21**2.00D+00+P3
	ZEDy=OVYC21**2.00D+00+P3
	ZEDz=OVZC21**2.00D+00+P3

	DZEDx=2.00D+00*OVXC21*DOVxC21+DP3
	DZEDy=2.00D+00*OVYC21*DOVyC21+DP3
	DZEDz=2.00D+00*OVZC21*DOVzC21+DP3

	DOVxC22=(OVLAP*DZEDx+ZEDx*DOVnDBZ)
	DOVyC22=(OVLAP*DZEDy+ZEDy*DOVnDBZ)
	DOVzC22=(OVLAP*DZEDz+ZEDz*DOVnDBZ)

	DOVC22=DOVxC22+DOVyC22+DOVzC22

	ZETA=(OVXC21*ACX+OVYC21*ACY+OVZC21*ACZ)
	DZETA=(DOVxC21*ACX+DACx*OVXC21+DOVyC21*ACY+DACy*OVYC21+DOVzC21*ACZ
	-+DACz*OVZC21)

	DOVC21=-2.00D+00*(DZETA*OVLAP+DOVnDBZ*ZETA)

	HEREx=PAX*GA2DEL-QCX*GA1DEL
	HEREy=PAY*GA2DEL-QCY*GA1DEL
	HEREz=PAZ*GA2DEL-QCZ*GA1DEL

	UTAx=(1.00D+00-((PQX**2.00D+00*DELT)/2.00D+00))*(GA2DEL/(8.00D+00*
	-GAMA1))
	UTAy=(1.00D+00-((PQY**2.00D+00*DELT)/2.00D+00))*(GA2DEL/(8.00D+00*
	-GAMA1))
	UTAz=(1.00D+00-((PQZ**2.00D+00*DELT)/2.00D+00))*(GA2DEL/(8.00D+00*
	-GAMA1))


	REDx=PAX*QCX + (1.00D+00/4.00D+00)*PQX*(HEREx) + UTAx
	REDy=PAY*QCY + (1.00D+00/4.00D+00)*PQY*(HEREy) + UTAy
	REDz=PAZ*QCZ + (1.00D+00/4.00D+00)*PQZ*(HEREz) + UTAz							   

	DINHEREx=0.00D+00
	DINHEREy=0.00D+00
	DINHEREz=-4.00D+00*(-1.00D+00+A3/GAMA2)*GAMA2*GAMA3/XMIAN

	DUTAx=0.00D+00
	DUTAy=0.00D+00
	DUTAz=2.00D+00*A3*GAMA1*GAMA3**2.00D+00*PQZ/XMIAN**2.00D+00


	DREDx=(PAX*DQCx+QCX*DPAx)+(1.00D+00/4.00D+00)*(PQX*DINHEREx+HEREx*
	-DPQx)+DUTAx
	DREDy=(PAY*DQCy+QCY*DPAy)+(1.00D+00/4.00D+00)*(PQY*DINHEREy+HEREy*
	-DPQy)+DUTAy
	DREDz=(PAZ*DQCz+QCZ*DPAz)+(1.00D+00/4.00D+00)*(PQZ*DINHEREz+HEREz*
	-DPQz)+DUTAz	

	DAx1Cx2=(OVLAP*DREDx + REDx*DOVnDBZ)
	DAy1Cy2=(OVLAP*DREDy + REDy*DOVnDBZ)
	DAz1Cz2=(OVLAP*DREDz + REDz*DOVnDBZ)

	DA1C2=-2.00D+00*(DAx1Cx2+DAy1Cy2+DAz1Cz2)

	DRHO=DOVA12+DOVA11+DOVC22+DOVC21+DA1C2

	DNKL=(DPT3*RHO + DRHO*PT3)

	DMKL=DNKL - (DPT2*OVA12 + DOVA12*PT2)

	DWKL=DMKL - (DPT1*OVB12 + DOVB12*PT1)

	QKL=(6.00D+00*(A1*A6DG3+A2*A5DG3)+4.00D+00*A5*A6*(ACX*ACX+ACY*ACY+
	-ACZ*ACZ))
	DQKL=-8.00D+00*ACZ*A5*A6

	DTKDBZ=DWKL + QKL*DOVnDBZ + OVLAP*DQKL

C	WRITE(6,*)'OVLAP=',OVLAP
C	WRITE(6,*)'DOVLAP=',DOVnDBZ
C	WRITE(6,*)'QKL=',QKL
C	WRITE(6,*)'DQKL=',DQKL
C	WRITE(6,*)'DWKL=',DWKL
C	STOP
C
	END IF
C
C
C     -----------------------------------------------------
C     --- OutPut FORMAT(s) ---
C     -----------------------------------------------------
900   FORMAT(1x,F10.5)
C     -----------------------------------------------------
C
C
      RETURN  
      END                                                                   

