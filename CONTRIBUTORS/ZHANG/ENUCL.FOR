C     Originallly Coded:  Z. Zhang
C           Modified By:  D. Gilmore ---> (24 May 95)
C     -----------------------------------------------------
C     L. ADAMOWICZ RESEARCH / UNIVERSITY OF ARIZONA / CHEM.
C     -----------------------------------------------------
      SUBROUTINE ENUCL(DFLAG,OVERLAP,AX,AY,AZ,A1,BX,BY,BZ,A2,                      
     1                 CX,CY,CZ,A3,DX,DY,DZ,A4,A5,A6,
     2                 EX,EY,EZ,EN,KLM)                       
C     -----------------------------------------------------
C     ENUCL INTGL_1 = <psi(L)@A|(-Z_C/|r1 - R_C|)|psi{k)@B>
C     -----------------------------------------------------
      IMPLICIT REAL*8 (A-H,O-Z)
	INTEGER DFLAG
C     -----------------------------------------------------
C     *** FOUR CENTER NUCLEAR ATTRACTION INTEGRAL ***
C     -----------------------------------------------------
	PARAMETER(C1=0.564691197D-04)
	PARAMETER(C2=0.758433197D-03)
	PARAMETER(C3=0.769838037D-02)
	PARAMETER(C4=0.629344460D-01)
	PARAMETER(C5=0.213271302D+00)
	PARAMETER(C6=0.720266520D-04)
	PARAMETER(C7=0.955528842D-03)
	PARAMETER(C8=0.101431553D-01)
	PARAMETER(C9=0.738522953D-01)
	PARAMETER(C10=0.338450368D+00)
	PARAMETER(C11=0.879937801D+00)
	PARAMETER(ONE=1.00D+00)
	PARAMETER(TWO=2.00D+00)
	PARAMETER(FOUR=4.00D+00)
	PARAMETER(SIX=6.00D+00)
	PARAMETER(EIGHT=8.00D+00)
	PARAMETER(HALF=0.50D+00)
	PARAMETER(PI=3.1415926535898D+00)
	PARAMETER(RX1=0.)
	PARAMETER(RX2=0.)
	PARAMETER(RY1=0.)
	PARAMETER(RY2=0.)
	PARAMETER(RRX=0.)
	PARAMETER(RRY=0.)
C
	COMMON /DEN/ DENDA1,DENDA2,DENDA5,DENDAZ,DENDBZ,
	1			 DENDA1P,DENDA2P,DENDA5P,DENDAZP,DENDBZP
	COMMON /DOVn/ DOVnDA1,DOVnDA2,DOVnDA5,DOVnDAZ,DOVnDBZ
C     -----------------------------------------------------
      ALK1=A1+A2                                                       
      ALK2=A3+A4                                                       
      BLK12=A5+A6  
      ALKXX=ALK2+BLK12
      DETAB=ALK1*ALK2+(ALK1+ALK2)*BLK12
      IF(ALKXX.LE.0.0D+00) GOTO 300
      IF(DETAB.LE.0.0D+00) GOTO 300                       
C     -----------------------------------------------------
C     --- ONE CENTER NUCLEAR INTEGRAL ---
C     -----------------------------------------------------
      RZ1=(A1*AZ+A2*BZ)/ALK1
      RZ2=(A3*CZ+A4*DZ)/ALK2
C     -----------------------------------------------------
C     --- FOUR-CENTER ELECTRON REPULSION INTEGRAL ---
C     -----------------------------------------------------
C
	EN=TWO*OVERLAP*DSQRT(DETAB/(PI*(ALK2+BLK12)))
C
      RRZ=(ALK1*(ALK2+BLK12)*RZ1+ALK2*BLK12*RZ2)/DETAB 
C
      RE2=(RRZ-EZ)**2
c	WRITE(6,*)'RE2=',RE2

C
      DELTA2=(ALK2+BLK12)/(FOUR*DETAB)
      RE2=RE2/(FOUR*DELTA2)
C



      EN=EN*F0(RE2) 
C     -----------------------------------------------------
	IF (DFLAG .EQ. 1) THEN
C
	Z=RE2
	PHIF=((((((C6*Z+C7)*Z+C8)*Z+C9)*Z+C10)*Z+C11)*Z+1.00D+00)
	THETAF=(((((C1*Z+C2)*Z+C3)*Z+C4)*Z+C5)*Z+1.00D+00)
C
	OKL=DSQRT(DETAB)
C
	QKL=(RRZ-EZ)**2.00D+00
C
	RRR=0.70055D+00+RRZ
	RRRN=-0.70055D+00+RRZ
	A1Z=A1*AZ
	A2Z=A2*BZ
	A3Z=A3*CZ
	A4Z=A4*DZ
	AZSUM=A1Z+A2Z+A3Z+A4Z
	AZSUM1=A1Z+A2Z
	AZSUM2=A3Z+A4Z
C
C	DENDA1:
C	======================================================
	DDETAB=ALKXX
C
	DZZ=QKL+DETAB*(2.00D+00*(ALKXX*AZ/DETAB-ALKXX*(ALKXX*AZSUM1
	-+BLK12*AZSUM2)/DETAB**2.00D+00)*RRRN)/ALKXX
C
	DTHETAF=(5.00D+00*C1*Z**4.00D+00+4.00D+00*C2*Z**3.00D+00+3.00D+00*
	-C3*Z**2.00D+00+2.00D+00*C4*Z+C5)*DZZ
C
	DPHIF=(6.00D+00*C6*Z**5.00D+00+5.00D+00*C7*Z**4.00D+00+4.00D+00*C8
	-*Z**3.00D+00+3.00D+00*C9*Z**2.00D+00+2.00D+00*C10*Z+C11)*DZZ
C
	DF0=(DSQRT(PHIF)/(2.00D+00*DSQRT(THETAF)))*(-(THETAF/PHIF**2.00D+0
	-0)*DPHIF+(1.00D+00/PHIF)*DTHETAF)
C
	FF=DSQRT(THETAF/PHIF)
C
C
	PKL=DSQRT(1.00D+00/(PI*(ALK2+BLK12)))
C
	ANKL=OKL*PKL
	AMKL=2.00D+00*OVERLAP*ANKL
	DOKL=(1.00D+00/(2.00D+00*DSQRT(DETAB)))*DDETAB
C
	DNkl=(PKL*DOKL)
C
	DMKL=2.00D+00*(OVERLAP*DNKL + ANKL*DOVnDA1)
C
	DENDA1=AMKL*DF0 + FF*DMKL
C
C	DENDA2:
C	======================================================
	DDETAB=ALK1+BLK12
C
	DZZ=(DDETAB)*QKL/ALKXX-DETAB*QKL/ALKXX**2.00D+00+DETAB*(
	-2.00D+00*((A1Z+A2Z+BLK12*CZ)/DETAB-(ALK1+BLK12)*(ALKX
     -X*AZSUM1+BLK12*AZSUM2)/DETAB**2.00D+00)*RRRN)/ALKXX
C
	DTHETAF=(5.00D+00*C1*Z**4.00D+00+4.00D+00*C2*Z**3.00D+00+3.00D+00*
	-C3*Z**2.00D+00+2.00D+00*C4*Z+C5)*DZZ
C
	DPHIF=(6.00D+00*C6*Z**5.00D+00+5.00D+00*C7*Z**4.00D+00+4.00D+00*C8
	-*Z**3.00D+00+3.00D+00*C9*Z**2.00D+00+2.00D+00*C10*Z+C11)*DZZ
C
	DF0=(DSQRT(PHIF)/(2.00D+00*DSQRT(THETAF)))*(-(THETAF/PHIF**2.00D+0
	-0)*DPHIF+(1.00D+00/PHIF)*DTHETAF)
C
	DPkl=(-1.00D+00/(2.00D+00*((PI*ALK2+PI*BLK12)*DSQRT((PI*ALK2+PI*BL
	-K12)))))*PI
C
	DOKL=(1.00D+00/(2.00D+00*DSQRT(DETAB)))*DDETAB
C
	DNkl=(OKL*DPKL + PKL*DOKL)
C
	DMKL=2.00D+00*(OVERLAP*DNKL + ANKL*DOVnDA2)
C
	DENDA2=AMKL*DF0 + FF*DMKL
C
C	DENDA5:
C	======================================================
	DDETAB=ALK1+ALK2
C
	DZZ=(DDETAB)*QKL/ALKXX-DETAB*QKL/ALKXX**2.00D+00+DETAB*(2.00D+00*
	-(AZSUM/DETAB-(ALK1+ALK2)*(ALKXX*AZSUM1
     -+BLK12*AZSUM2)/DETAB**2.00D+00)*RRRN)/ALKXX
C
	DTHETAF=(5.00D+00*C1*Z**4.00D+00+4.00D+00*C2*Z**3.00D+00+3.00D+00*
	-C3*Z**2.00D+00+2.00D+00*C4*Z+C5)*DZZ
C
	DPHIF=(6.00D+00*C6*Z**5.00D+00+5.00D+00*C7*Z**4.00D+00+4.00D+00*C8
	-*Z**3.00D+00+3.00D+00*C9*Z**2.00D+00+2.00D+00*C10*Z+C11)*DZZ
C
	DF0=(DSQRT(PHIF)/(2.00D+00*DSQRT(THETAF)))*(-(THETAF/PHIF**2.00D+0
	-0)*DPHIF+(1.00D+00/PHIF)*DTHETAF)
C
	DPkl=(-1.00D+00/(2.00D+00*((PI*ALK2+PI*BLK12)*DSQRT((PI*ALK2+PI*BL
	-K12)))))*PI
C
	DOKL=(1.00D+00/(2.00D+00*DSQRT(DETAB)))*DDETAB
C
	DNkl=(OKL*DPKL + PKL*DOKL)
C
	DMKL=2.00D+00*(OVERLAP*DNKL + ANKL*DOVnDA5)
C
	DENDA5=AMKL*DF0 + FF*DMKL
C
C	DENDAZ:
C	======================================================
	DZZ=2.00D+00*A1*RRRN
C
	DTHETAF=(5.00D+00*C1*Z**4.00D+00+4.00D+00*C2*Z**3.00D+00+3.00D+00*
	-C3*Z**2.00D+00+2.00D+00*C4*Z+C5)*DZZ
C
	DPHIF=(6.00D+00*C6*Z**5.00D+00+5.00D+00*C7*Z**4.00D+00+4.00D+00*C8
	-*Z**3.00D+00+3.00D+00*C9*Z**2.00D+00+2.00D+00*C10*Z+C11)*DZZ
C
	DF0=(DSQRT(PHIF)/(2.00D+00*DSQRT(THETAF)))*(-(THETAF/PHIF**2.00D+0
	-0)*DPHIF+(1.00D+00/PHIF)*DTHETAF)
C
	DMKL=2.00D+00*(ANKL*DOVnDAZ)
C
	DENDAZ=AMKL*DF0 + FF*DMKL
C
C	DENDBZ:
C	======================================================
	DZZ=2.00D+00*A3*BLK12*RRRN/ALKXX
C
	DTHETAF=(5.00D+00*C1*Z**4.00D+00+4.00D+00*C2*Z**3.00D+00+3.00D+00*
	-C3*Z**2.00D+00+2.00D+00*C4*Z+C5)*DZZ
C
	DPHIF=(6.00D+00*C6*Z**5.00D+00+5.00D+00*C7*Z**4.00D+00+4.00D+00*C8
	-*Z**3.00D+00+3.00D+00*C9*Z**2.00D+00+2.00D+00*C10*Z+C11)*DZZ
C
	DF0=(DSQRT(PHIF)/(2.00D+00*DSQRT(THETAF)))*(-(THETAF/PHIF**2.00D+0
	-0)*DPHIF+(1.00D+00/PHIF)*DTHETAF)
C
	DMKL=2.00D+00*(ANKL*DOVnDBZ)
C
	DENDBZ=AMKL*DF0 + FF*DMKL
C
C
C	DENDA1P:
C	======================================================
	DDETAB=ALKXX
C
	DZZ=QKL+DETAB*(2.00D+00*(ALKXX*AZ/DETAB-ALKXX*(ALKXX*AZSUM1
	-+BLK12*AZSUM2)/DETAB**2.00D+00)*RRR)/ALKXX
C
	DTHETAF=(5.00D+00*C1*Z**4.00D+00+4.00D+00*C2*Z**3.00D+00+3.00D+00*
	-C3*Z**2.00D+00+2.00D+00*C4*Z+C5)*DZZ
C
	DPHIF=(6.00D+00*C6*Z**5.00D+00+5.00D+00*C7*Z**4.00D+00+4.00D+00*C8
	-*Z**3.00D+00+3.00D+00*C9*Z**2.00D+00+2.00D+00*C10*Z+C11)*DZZ
C
	DF0=(DSQRT(PHIF)/(2.00D+00*DSQRT(THETAF)))*(-(THETAF/PHIF**2.00D+0
	-0)*DPHIF+(1.00D+00/PHIF)*DTHETAF)
C
	DOKL=(1.00D+00/(2.00D+00*DSQRT(DETAB)))*DDETAB
C
	DNkl=(PKL*DOKL)
C
	DMKL=2.00D+00*(OVERLAP*DNKL + ANKL*DOVnDA1)
C
	DENDA1P=AMKL*DF0 + FF*DMKL
C
C	DENDA2P:
C	======================================================
	DDETAB=ALK1+BLK12
C
	DZZ=(DDETAB)*QKL/ALKXX-DETAB*QKL/ALKXX**2.00D+00+DETAB*(2.00D+00*
	-((A1Z+A2Z+BLK12*CZ)/
	-DETAB-(ALK1+BLK12)*(ALKXX*AZSUM1+BLK12*AZSUM2)/
     -DETAB**2.00D+00)*RRR)/ALKXX
C
	DTHETAF=(5.00D+00*C1*Z**4.00D+00+4.00D+00*C2*Z**3.00D+00+3.00D+00*
	-C3*Z**2.00D+00+2.00D+00*C4*Z+C5)*DZZ
C
	DPHIF=(6.00D+00*C6*Z**5.00D+00+5.00D+00*C7*Z**4.00D+00+4.00D+00*C8
	-*Z**3.00D+00+3.00D+00*C9*Z**2.00D+00+2.00D+00*C10*Z+C11)*DZZ
C
	DF0=(DSQRT(PHIF)/(2.00D+00*DSQRT(THETAF)))*(-(THETAF/PHIF**2.00D+0
	-0)*DPHIF+(1.00D+00/PHIF)*DTHETAF)
C
	DPkl=(-1.00D+00/(2.00D+00*((PI*ALK2+PI*BLK12)*DSQRT((PI*ALK2+PI*BL
	-K12)))))*PI
C
	DOKL=(1.00D+00/(2.00D+00*DSQRT(DETAB)))*DDETAB
C
	DNkl=(OKL*DPKL + PKL*DOKL)
C
	DMKL=2.00D+00*(OVERLAP*DNKL + ANKL*DOVnDA2)
C
	DENDA2P=AMKL*DF0 + FF*DMKL
C
C	DENDA5P:
C	======================================================
	DDETAB=ALK1+ALK2
C
	DZZ=(DDETAB)*QKL/ALKXX-DETAB*QKL/ALKXX**2.00D+00+DETAB*(2.00D+00*
	-(AZSUM/DETAB-(ALK1+ALK2)*
     -(ALKXX*AZSUM1+BLK12*AZSUM2)/DETAB**2.00D+00)*RRR)/
     -ALKXX
C
	DTHETAF=(5.00D+00*C1*Z**4.00D+00+4.00D+00*C2*Z**3.00D+00+3.00D+00*
	-C3*Z**2.00D+00+2.00D+00*C4*Z+C5)*DZZ
C
	DPHIF=(6.00D+00*C6*Z**5.00D+00+5.00D+00*C7*Z**4.00D+00+4.00D+00*C8
	-*Z**3.00D+00+3.00D+00*C9*Z**2.00D+00+2.00D+00*C10*Z+C11)*DZZ
C
	DF0=(DSQRT(PHIF)/(2.00D+00*DSQRT(THETAF)))*(-(THETAF/PHIF**2.00D+0
	-0)*DPHIF+(1.00D+00/PHIF)*DTHETAF)
C
	DPkl=(-1.00D+00/(2.00D+00*((PI*ALK2+PI*BLK12)*DSQRT((PI*ALK2+PI*BL
	-K12)))))*PI
C
	DOKL=(1.00D+00/(2.00D+00*DSQRT(DETAB)))*DDETAB
C
	DNkl=(OKL*DPKL + PKL*DOKL)
C
	DMKL=2.00D+00*(OVERLAP*DNKL + ANKL*DOVnDA5)
C
	DENDA5P=AMKL*DF0 + FF*DMKL
C
C	DENDAZP:
C	======================================================
	DZZ=2.00D+00*A1*RRR
C
	DTHETAF=(5.00D+00*C1*Z**4.00D+00+4.00D+00*C2*Z**3.00D+00+3.00D+00*
	-C3*Z**2.00D+00+2.00D+00*C4*Z+C5)*DZZ
C
	DPHIF=(6.00D+00*C6*Z**5.00D+00+5.00D+00*C7*Z**4.00D+00+4.00D+00*C8
	-*Z**3.00D+00+3.00D+00*C9*Z**2.00D+00+2.00D+00*C10*Z+C11)*DZZ
C
	DF0=(DSQRT(PHIF)/(2.00D+00*DSQRT(THETAF)))*(-(THETAF/PHIF**2.00D+0
	-0)*DPHIF+(1.00D+00/PHIF)*DTHETAF)
C
	DMKL=2.00D+00*(ANKL*DOVnDAZ)
C
	DENDAZP=AMKL*DF0 + FF*DMKL
C
C	DENDBZP:
C	======================================================
	DZZ=2.00D+00*A3*BLK12*RRR/ALKXX
C
	DTHETAF=(5.00D+00*C1*Z**4.00D+00+4.00D+00*C2*Z**3.00D+00+3.00D+00*
	-C3*Z**2.00D+00+2.00D+00*C4*Z+C5)*DZZ
C
	DPHIF=(6.00D+00*C6*Z**5.00D+00+5.00D+00*C7*Z**4.00D+00+4.00D+00*C8
	-*Z**3.00D+00+3.00D+00*C9*Z**2.00D+00+2.00D+00*C10*Z+C11)*DZZ
C
	DF0=(DSQRT(PHIF)/(2.00D+00*DSQRT(THETAF)))*(-(THETAF/PHIF**2.00D+0
	-0)*DPHIF+(1.00D+00/PHIF)*DTHETAF)
C
	DMKL=2.00D+00*(ANKL*DOVnDBZ)
C
	DENDBZP=AMKL*DF0 + FF*DMKL
C
C
	END IF
C
 300	KLM=5
C
C
1500  RETURN                                                            
      END 
